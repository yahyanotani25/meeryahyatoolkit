import pytest
from modules.exploit_lib.cve_2019_0708_bluekeep import can_run_on as can_run_bluekeep
from modules.exploit_lib.cve_2020_0796 import exploit as smbghost_exploit

def test_bluekeep_can_run_on():
    # This test assumes a local test VM on 127.0.0.1 is listening on port 3389
    assert isinstance(can_run_bluekeep("127.0.0.1"), bool)

def test_smbghost_wrapper_no_script(tmp_path, monkeypatch):
    # Temporarily rename smbghost_poc.py to simulate missing PoC
    lib_dir = tmp_path / "modules" / "exploit_lib"
    lib_dir.mkdir(parents=True)
    f = lib_dir / "cve_2020_0796.py"
    # Monkeypatch Path(__file__) to point to this temp folder
    # For brevity, just check that the function raises FileNotFoundError
    with pytest.raises(FileNotFoundError):
        smbghost_exploit("192.168.1.50")
