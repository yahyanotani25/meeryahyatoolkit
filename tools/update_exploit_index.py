# File: tools/update_exploit_index.py

import os
import hashlib
import json
from pathlib import Path

EXPLOIT_DIR = Path(__file__).parent.parent / "modules" / "exploit_lib"
INDEX_FILE = EXPLOIT_DIR / "exploits_index.json"

def main():
    idx = {}
    for py in EXPLOIT_DIR.glob("*.py"):
        h = hashlib.sha256(py.read_bytes()).hexdigest()
        idx[py.stem] = h
    with open(INDEX_FILE, "w") as f:
        json.dump(idx, f, indent=2)
    print(f"Updated {INDEX_FILE}")

if __name__ == "__main__":
    main()
